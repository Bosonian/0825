import{t as m}from"./research-tools-BkedTj7J.js";import{s as v}from"./enterprise-features-DIAO-rWl.js";import{f as H}from"./prediction-models-DCU63o_D.js";const U={bayern:{neurosurgicalCenters:[{id:"BY-NS-001",name:"LMU Klinikum M√ºnchen - Gro√ühadern",address:"Marchioninistra√üe 15, 81377 M√ºnchen",coordinates:{lat:48.1106,lng:11.4684},phone:"+49 89 4400-0",emergency:"+49 89 4400-73331",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1440,network:"TEMPiS"},{id:"BY-NS-002",name:"Klinikum rechts der Isar M√ºnchen (TUM)",address:"Ismaninger Str. 22, 81675 M√ºnchen",coordinates:{lat:48.1497,lng:11.6052},phone:"+49 89 4140-0",emergency:"+49 89 4140-2249",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1161,network:"TEMPiS"},{id:"BY-NS-003",name:"St√§dtisches Klinikum M√ºnchen Schwabing",address:"K√∂lner Platz 1, 80804 M√ºnchen",coordinates:{lat:48.1732,lng:11.5755},phone:"+49 89 3068-0",emergency:"+49 89 3068-2050",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:648,network:"TEMPiS"},{id:"BY-NS-004",name:"St√§dtisches Klinikum M√ºnchen Bogenhausen",address:"Englschalkinger Str. 77, 81925 M√ºnchen",coordinates:{lat:48.1614,lng:11.6254},phone:"+49 89 9270-0",emergency:"+49 89 9270-2050",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:689,network:"TEMPiS"},{id:"BY-NS-005",name:"Universit√§tsklinikum Erlangen",address:"Maximiliansplatz 2, 91054 Erlangen",coordinates:{lat:49.5982,lng:11.0037},phone:"+49 9131 85-0",emergency:"+49 9131 85-39003",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1371,network:"TEMPiS"},{id:"BY-NS-006",name:"Universit√§tsklinikum Regensburg",address:"Franz-Josef-Strau√ü-Allee 11, 93053 Regensburg",coordinates:{lat:49.0134,lng:12.0991},phone:"+49 941 944-0",emergency:"+49 941 944-7501",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1042,network:"TEMPiS"},{id:"BY-NS-007",name:"Universit√§tsklinikum W√ºrzburg",address:"Oberd√ºrrbacher Str. 6, 97080 W√ºrzburg",coordinates:{lat:49.784,lng:9.9721},phone:"+49 931 201-0",emergency:"+49 931 201-24444",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1264,network:"TEMPiS"},{id:"BY-NS-008",name:"Klinikum N√ºrnberg Nord",address:"Prof.-Ernst-Nathan-Str. 1, 90419 N√ºrnberg",coordinates:{lat:49.4521,lng:11.0767},phone:"+49 911 398-0",emergency:"+49 911 398-2369",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1368,network:"TEMPiS"},{id:"BY-NS-009",name:"Universit√§tsklinikum Augsburg",address:"Stenglinstr. 2, 86156 Augsburg",coordinates:{lat:48.3668,lng:10.9093},phone:"+49 821 400-01",emergency:"+49 821 400-2356",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1740,network:"TEMPiS"},{id:"BY-NS-010",name:"Klinikum Aschaffenburg-Alzenau",address:"Am Hasenkopf 1, 63739 Aschaffenburg",coordinates:{lat:49.9737,lng:9.157},phone:"+49 6021 32-0",emergency:"+49 6021 32-2800",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:40,network:"TRANSIT"},{id:"BY-NS-011",name:"Klinikum Landshut",address:"Robert-Koch-Str. 1, 84034 Landshut",coordinates:{lat:48.5665,lng:12.1512},phone:"+49 871 698-0",emergency:"+49 871 698-3333",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:505,network:"TEMPiS"},{id:"BY-NS-012",name:"Klinikum Coburg",address:"Ketschendorfer Str. 33, 96450 Coburg",coordinates:{lat:50.2596,lng:10.9644},phone:"+49 9561 22-0",emergency:"+49 9561 22-6800",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:547,network:"STENO"},{id:"BY-NS-013",name:"Klinikum Passau",address:"Bischof-Pilgrim-Str. 1, 94032 Passau",coordinates:{lat:48.5665,lng:13.4777},phone:"+49 851 5300-0",emergency:"+49 851 5300-2222",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:696,network:"TEMPiS"}],comprehensiveStrokeCenters:[{id:"BY-CS-001",name:"Klinikum Bamberg",address:"Buger Str. 80, 96049 Bamberg",coordinates:{lat:49.8988,lng:10.9027},phone:"+49 951 503-0",emergency:"+49 951 503-11101",thrombectomy:!0,thrombolysis:!0,beds:630,network:"TEMPiS"},{id:"BY-CS-002",name:"Klinikum Bayreuth",address:"Preuschwitzer Str. 101, 95445 Bayreuth",coordinates:{lat:49.9459,lng:11.5779},phone:"+49 921 400-0",emergency:"+49 921 400-5401",thrombectomy:!0,thrombolysis:!0,beds:848,network:"TEMPiS"},{id:"BY-CS-003",name:"Klinikum Coburg",address:"Ketschendorfer Str. 33, 96450 Coburg",coordinates:{lat:50.2596,lng:10.9685},phone:"+49 9561 22-0",emergency:"+49 9561 22-6300",thrombectomy:!0,thrombolysis:!0,beds:522,network:"TEMPiS"}],regionalStrokeUnits:[{id:"BY-RSU-001",name:"Goldberg-Klinik Kelheim",address:"Traubenweg 3, 93309 Kelheim",coordinates:{lat:48.9166,lng:11.8742},phone:"+49 9441 702-0",emergency:"+49 9441 702-6800",thrombolysis:!0,beds:200,network:"TEMPiS"},{id:"BY-RSU-002",name:"DONAUISAR Klinikum Deggendorf",address:"Perlasberger Str. 41, 94469 Deggendorf",coordinates:{lat:48.8372,lng:12.9619},phone:"+49 991 380-0",emergency:"+49 991 380-2201",thrombolysis:!0,beds:450,network:"TEMPiS"},{id:"BY-RSU-003",name:"Klinikum St. Elisabeth Straubing",address:"St.-Elisabeth-Str. 23, 94315 Straubing",coordinates:{lat:48.8742,lng:12.5733},phone:"+49 9421 710-0",emergency:"+49 9421 710-2000",thrombolysis:!0,beds:580,network:"TEMPiS"},{id:"BY-RSU-004",name:"Klinikum Freising",address:"Mainburger Str. 29, 85356 Freising",coordinates:{lat:48.4142,lng:11.7461},phone:"+49 8161 24-0",emergency:"+49 8161 24-2800",thrombolysis:!0,beds:380,network:"TEMPiS"},{id:"BY-RSU-005",name:"Klinikum Landkreis Erding",address:"Bajuwarenstr. 5, 85435 Erding",coordinates:{lat:48.3061,lng:11.9067},phone:"+49 8122 59-0",emergency:"+49 8122 59-2201",thrombolysis:!0,beds:350,network:"TEMPiS"},{id:"BY-RSU-006",name:"Helios Amper-Klinikum Dachau",address:"Krankenhausstr. 15, 85221 Dachau",coordinates:{lat:48.2599,lng:11.4342},phone:"+49 8131 76-0",emergency:"+49 8131 76-2201",thrombolysis:!0,beds:480,network:"TEMPiS"},{id:"BY-RSU-007",name:"Klinikum F√ºrstenfeldbruck",address:"Dachauer Str. 33, 82256 F√ºrstenfeldbruck",coordinates:{lat:48.1772,lng:11.2578},phone:"+49 8141 99-0",emergency:"+49 8141 99-2201",thrombolysis:!0,beds:420,network:"TEMPiS"},{id:"BY-RSU-008",name:"Klinikum Ingolstadt",address:"Krumenauerstra√üe 25, 85049 Ingolstadt",coordinates:{lat:48.7665,lng:11.4364},phone:"+49 841 880-0",emergency:"+49 841 880-2201",thrombolysis:!0,beds:665,network:"TEMPiS"},{id:"BY-RSU-009",name:"Klinikum Passau",address:"Bischof-Pilgrim-Str. 1, 94032 Passau",coordinates:{lat:48.5665,lng:13.4513},phone:"+49 851 5300-0",emergency:"+49 851 5300-2100",thrombolysis:!0,beds:540,network:"TEMPiS"},{id:"BY-RSU-010",name:"Klinikum Landshut",address:"Robert-Koch-Str. 1, 84034 Landshut",coordinates:{lat:48.5436,lng:12.1619},phone:"+49 871 698-0",emergency:"+49 871 698-3333",thrombolysis:!0,beds:790,network:"TEMPiS"},{id:"BY-RSU-011",name:"RoMed Klinikum Rosenheim",address:"Pettenkoferstr. 10, 83022 Rosenheim",coordinates:{lat:47.8567,lng:12.1265},phone:"+49 8031 365-0",emergency:"+49 8031 365-3711",thrombolysis:!0,beds:870,network:"TEMPiS"},{id:"BY-RSU-012",name:"Klinikum Memmingen",address:"Bismarckstr. 23, 87700 Memmingen",coordinates:{lat:47.9833,lng:10.1833},phone:"+49 8331 70-0",emergency:"+49 8331 70-2500",thrombolysis:!0,beds:520,network:"TEMPiS"},{id:"BY-RSU-013",name:"Klinikum Kempten-Oberallg√§u",address:"Robert-Weixler-Str. 50, 87439 Kempten",coordinates:{lat:47.7261,lng:10.3097},phone:"+49 831 530-0",emergency:"+49 831 530-2201",thrombolysis:!0,beds:650,network:"TEMPiS"},{id:"BY-RSU-014",name:"Klinikum Aschaffenburg-Alzenau",address:"Am Hasenkopf 1, 63739 Aschaffenburg",coordinates:{lat:49.9747,lng:9.1581},phone:"+49 6021 32-0",emergency:"+49 6021 32-2700",thrombolysis:!0,beds:590,network:"TEMPiS"}],thrombolysisHospitals:[{id:"BY-TH-001",name:"Krankenhaus Vilsbiburg",address:"Sonnenstra√üe 10, 84137 Vilsbiburg",coordinates:{lat:48.6333,lng:12.2833},phone:"+49 8741 60-0",thrombolysis:!0,beds:180},{id:"BY-TH-002",name:"Krankenhaus Eggenfelden",address:"Pfarrkirchener Str. 5, 84307 Eggenfelden",coordinates:{lat:48.4,lng:12.7667},phone:"+49 8721 98-0",thrombolysis:!0,beds:220}]},badenWuerttemberg:{neurosurgicalCenters:[{id:"BW-NS-001",name:"Universit√§tsklinikum Freiburg",address:"Hugstetter Str. 55, 79106 Freiburg",coordinates:{lat:48.0025,lng:7.8347},phone:"+49 761 270-0",emergency:"+49 761 270-34010",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1600,network:"FAST"},{id:"BW-NS-002",name:"Universit√§tsklinikum Heidelberg",address:"Im Neuenheimer Feld 400, 69120 Heidelberg",coordinates:{lat:49.4178,lng:8.6706},phone:"+49 6221 56-0",emergency:"+49 6221 56-36643",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1621,network:"FAST"},{id:"BW-NS-003",name:"Universit√§tsklinikum T√ºbingen",address:"Geissweg 3, 72076 T√ºbingen",coordinates:{lat:48.5378,lng:9.0538},phone:"+49 7071 29-0",emergency:"+49 7071 29-82211",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1550,network:"FAST"},{id:"BW-NS-004",name:"Universit√§tsklinikum Ulm",address:"Albert-Einstein-Allee 23, 89081 Ulm",coordinates:{lat:48.4196,lng:9.9592},phone:"+49 731 500-0",emergency:"+49 731 500-63001",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1264,network:"FAST"},{id:"BW-NS-005",name:"Klinikum Stuttgart - Katharinenhospital",address:"Kriegsbergstra√üe 60, 70174 Stuttgart",coordinates:{lat:48.7784,lng:9.1682},phone:"+49 711 278-0",emergency:"+49 711 278-32001",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:950,network:"FAST"},{id:"BW-NS-006",name:"St√§dtisches Klinikum Karlsruhe",address:"Moltkestra√üe 90, 76133 Karlsruhe",coordinates:{lat:49.0047,lng:8.3858},phone:"+49 721 974-0",emergency:"+49 721 974-2301",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1570,network:"FAST"},{id:"BW-NS-007",name:"Klinikum Ludwigsburg",address:"Posilipostra√üe 4, 71640 Ludwigsburg",coordinates:{lat:48.8901,lng:9.1953},phone:"+49 7141 99-0",emergency:"+49 7141 99-67201",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:720,network:"FAST"}],comprehensiveStrokeCenters:[{id:"BW-CS-001",name:"Universit√§tsmedizin Mannheim",address:"Theodor-Kutzer-Ufer 1-3, 68167 Mannheim",coordinates:{lat:49.4828,lng:8.4664},phone:"+49 621 383-0",emergency:"+49 621 383-2251",thrombectomy:!0,thrombolysis:!0,beds:1400,network:"FAST"}],regionalStrokeUnits:[{id:"BW-RSU-001",name:"Robert-Bosch-Krankenhaus Stuttgart",address:"Auerbachstra√üe 110, 70376 Stuttgart",coordinates:{lat:48.7447,lng:9.2294},phone:"+49 711 8101-0",emergency:"+49 711 8101-3456",thrombolysis:!0,beds:850,network:"FAST"}],thrombolysisHospitals:[]},nordrheinWestfalen:{neurosurgicalCenters:[{id:"NRW-NS-001",name:"Universit√§tsklinikum D√ºsseldorf",address:"Moorenstra√üe 5, 40225 D√ºsseldorf",coordinates:{lat:51.1906,lng:6.8064},phone:"+49 211 81-0",emergency:"+49 211 81-17700",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1300,network:"NEVANO+"},{id:"NRW-NS-002",name:"Universit√§tsklinikum K√∂ln",address:"Kerpener Str. 62, 50937 K√∂ln",coordinates:{lat:50.9253,lng:6.9187},phone:"+49 221 478-0",emergency:"+49 221 478-32500",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1500,network:"NEVANO+"},{id:"NRW-NS-003",name:"Universit√§tsklinikum Essen",address:"Hufelandstra√üe 55, 45147 Essen",coordinates:{lat:51.4285,lng:7.0073},phone:"+49 201 723-0",emergency:"+49 201 723-84444",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1350,network:"NEVANO+"},{id:"NRW-NS-004",name:"Universit√§tsklinikum M√ºnster",address:"Albert-Schweitzer-Campus 1, 48149 M√ºnster",coordinates:{lat:51.9607,lng:7.6261},phone:"+49 251 83-0",emergency:"+49 251 83-47255",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1513,network:"NEVANO+"},{id:"NRW-NS-005",name:"Universit√§tsklinikum Bonn",address:"Venusberg-Campus 1, 53127 Bonn",coordinates:{lat:50.6916,lng:7.1127},phone:"+49 228 287-0",emergency:"+49 228 287-15107",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1200,network:"NEVANO+"},{id:"NRW-NS-006",name:"Klinikum Dortmund",address:"Beurhausstra√üe 40, 44137 Dortmund",coordinates:{lat:51.5036,lng:7.4663},phone:"+49 231 953-0",emergency:"+49 231 953-20050",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:1200,network:"NVNR"},{id:"NRW-NS-007",name:"Rhein-Maas Klinikum W√ºrselen",address:"Mauerfeldstra√üe 25, 52146 W√ºrselen",coordinates:{lat:50.8178,lng:6.1264},phone:"+49 2405 62-0",emergency:"+49 2405 62-2222",neurosurgery:!0,thrombectomy:!0,thrombolysis:!0,beds:420,network:"NEVANO+"}],comprehensiveStrokeCenters:[{id:"NRW-CS-001",name:"Universit√§tsklinikum Aachen",address:"Pauwelsstra√üe 30, 52074 Aachen",coordinates:{lat:50.778,lng:6.0614},phone:"+49 241 80-0",emergency:"+49 241 80-89611",thrombectomy:!0,thrombolysis:!0,beds:1400,network:"NEVANO+"}],regionalStrokeUnits:[{id:"NRW-RSU-001",name:"Helios Universit√§tsklinikum Wuppertal",address:"Heusnerstra√üe 40, 42283 Wuppertal",coordinates:{lat:51.2467,lng:7.1703},phone:"+49 202 896-0",emergency:"+49 202 896-2180",thrombolysis:!0,beds:1050,network:"NEVANO+"}],thrombolysisHospitals:[{id:"NRW-TH-009",name:"Elisabeth-Krankenhaus Essen",address:"Klara-Kopp-Weg 1, 45138 Essen",coordinates:{lat:51.4495,lng:7.0137},phone:"+49 201 897-0",thrombolysis:!0,beds:583},{id:"NRW-TH-010",name:"Klinikum Oberberg Gummersbach",address:"Wilhelm-Breckow-Allee 20, 51643 Gummersbach",coordinates:{lat:51.0277,lng:7.5694},phone:"+49 2261 17-0",thrombolysis:!0,beds:431},{id:"NRW-TH-011",name:"St. Vincenz-Krankenhaus Limburg",address:"Auf dem Schafsberg, 65549 Limburg",coordinates:{lat:50.3856,lng:8.0584},phone:"+49 6431 292-0",thrombolysis:!0,beds:452},{id:"NRW-TH-012",name:"Klinikum L√ºdenscheid",address:"Paulmannsh√∂her Stra√üe 14, 58515 L√ºdenscheid",coordinates:{lat:51.2186,lng:7.6298},phone:"+49 2351 46-0",thrombolysis:!0,beds:869}]}},O={routePatient(e){const{location:r,state:t,ichProbability:o,timeFromOnset:s,clinicalFactors:n}=e,a=t||this.detectState(r),i=U[a];if(o>=.5){const c=this.findNearest(r,i.neurosurgicalCenters);if(!c)throw new Error(`No neurosurgical centers available in ${a}`);return{category:"NEUROSURGICAL_CENTER",destination:c,urgency:"IMMEDIATE",reasoning:"High bleeding probability (‚â•50%) - neurosurgical evaluation required",preAlert:"Activate neurosurgery team",bypassLocal:!0,threshold:"‚â•50%",state:a}}if(o>=.3){const c=[...i.neurosurgicalCenters,...i.comprehensiveStrokeCenters];return{category:"COMPREHENSIVE_CENTER",destination:this.findNearest(r,c),urgency:"URGENT",reasoning:"Intermediate bleeding risk (30-50%) - CT and possible intervention",preAlert:"Prepare for possible neurosurgical consultation",transferPlan:this.findNearest(r,i.neurosurgicalCenters),threshold:"30-50%",state:a}}if(s&&s<=270){const c=[...i.neurosurgicalCenters,...i.comprehensiveStrokeCenters,...i.regionalStrokeUnits,...i.thrombolysisHospitals];return{category:"THROMBOLYSIS_CAPABLE",destination:this.findNearest(r,c),urgency:"TIME_CRITICAL",reasoning:"Low bleeding risk (<30%), within tPA window - nearest thrombolysis",preAlert:"Prepare for thrombolysis protocol",bypassLocal:!1,threshold:"<30%",timeWindow:"‚â§4.5h",state:a}}const l=[...i.neurosurgicalCenters,...i.comprehensiveStrokeCenters,...i.regionalStrokeUnits];return{category:"STROKE_UNIT",destination:this.findNearest(r,l),urgency:"STANDARD",reasoning:s>270?"Low bleeding risk, outside tPA window - standard stroke evaluation":"Low bleeding risk - standard stroke evaluation",preAlert:"Standard stroke protocol",bypassLocal:!1,threshold:"<30%",timeWindow:s?">4.5h":"unknown",state:a}},detectState(e){return e.lat>=47.5&&e.lat<=49.8&&e.lng>=7.5&&e.lng<=10.2?"badenWuerttemberg":e.lat>=50.3&&e.lat<=52.5&&e.lng>=5.9&&e.lng<=9.5?"nordrheinWestfalen":e.lat>=47.2&&e.lat<=50.6&&e.lng>=10.2&&e.lng<=13.8?"bayern":this.findNearestState(e)},findNearestState(e){const r={bayern:{lat:49,lng:11.5},badenWuerttemberg:{lat:48.5,lng:9},nordrheinWestfalen:{lat:51.5,lng:7.5}};let t="bayern",o=1/0;for(const[s,n]of Object.entries(r)){const a=this.calculateDistance(e,n);a<o&&(o=a,t=s)}return t},findNearest(e,r){return!r||r.length===0?null:r.map(t=>!t.coordinates||typeof t.coordinates.lat!="number"?null:{...t,distance:this.calculateDistance(e,t.coordinates)}).filter(t=>t!==null).sort((t,o)=>t.distance-o.distance)[0]},calculateDistance(e,r){const o=this.toRad(r.lat-e.lat),s=this.toRad(r.lng-e.lng),n=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.toRad(e.lat))*Math.cos(this.toRad(r.lat))*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)))},toRad(e){return e*(Math.PI/180)}};function P(e,r,t,o){const n=A(t-e),a=A(o-r),i=Math.sin(n/2)*Math.sin(n/2)+Math.cos(A(e))*Math.cos(A(t))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}function A(e){return e*(Math.PI/180)}async function Y(e,r,t,o,s="driving-car"){try{const n=`https://api.openrouteservice.org/v2/directions/${s}`,i=await fetch(n,{method:"POST",headers:{Accept:"application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8",Authorization:"5b3ce3597851110001cf624868c4c27b63ae476c9c26c8bffbc35688","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({coordinates:[[r,e],[o,t]],radiuses:[1e3,1e3],format:"json"})});if(!i.ok)throw new Error(`Routing API error: ${i.status}`);const l=await i.json();if(l.routes&&l.routes.length>0){const c=l.routes[0];return{duration:Math.round(c.summary.duration/60),distance:Math.round(c.summary.distance/1e3),source:"routing"}}throw new Error("No route found")}catch(n){let a="estimated";n.name==="TypeError"&&n.message.includes("Failed to fetch")?(console.info("[TravelTime] OpenRouteService blocked by CORS, using distance estimation"),a="cors-fallback"):n.message.includes("signal")?(console.info("[TravelTime] OpenRouteService timeout, using distance estimation"),a="timeout-fallback"):(console.info("[TravelTime] OpenRouteService error, using distance estimation:",n.message),a="error-fallback");const i=P(e,r,t,o);return{duration:Math.round(i/.8),distance:Math.round(i),source:a}}}async function L(e,r,t,o){try{const s=await Y(e,r,t,o,"driving-car");return{duration:Math.round(s.duration*.75),distance:s.distance,source:s.source==="routing"?"emergency-routing":"emergency-estimated"}}catch(s){const n=P(e,r,t,o);return{duration:Math.round(n/1.2),distance:Math.round(n),source:"emergency-estimated"}}}function X(e){return`
    <div class="stroke-center-section">
      <h3>üè• ${m("nearestCentersTitle")}</h3>
      <div id="locationContainer">
        <div class="location-controls">
          <button type="button" id="useGpsButton" class="secondary">
            üìç ${m("useCurrentLocation")}
          </button>
          <div class="location-manual" style="display: none;">
            <input type="text" id="locationInput" placeholder="${m("enterLocationPlaceholder")||"e.g. M√ºnchen, K√∂ln, Stuttgart, or 48.1351, 11.5820"}" />
            <button type="button" id="searchLocationButton" class="secondary">${m("search")}</button>
          </div>
          <button type="button" id="manualLocationButton" class="secondary">
            ‚úèÔ∏è ${m("enterManually")}
          </button>
        </div>
        <div id="strokeCenterResults" class="stroke-center-results"></div>
      </div>
    </div>
  `}function Q(e){console.log("[StrokeMap] Initializing stroke center map with results:",e);const r=document.getElementById("useGpsButton"),t=document.getElementById("manualLocationButton"),o=document.querySelector(".location-manual"),s=document.getElementById("locationInput"),n=document.getElementById("searchLocationButton"),a=document.getElementById("strokeCenterResults");console.log("[StrokeMap] Found elements:",{useGpsButton:!!r,manualLocationButton:!!t,locationManual:!!o,locationInput:!!s,searchLocationButton:!!n,resultsContainer:!!a}),r&&r.addEventListener("click",()=>{z(e,a)}),t&&t.addEventListener("click",()=>{o.style.display=o.style.display==="none"?"block":"none"}),n&&n.addEventListener("click",()=>{const i=s.value.trim();i&&F(i,e,a)}),s&&s.addEventListener("keypress",i=>{if(i.key==="Enter"){const l=s.value.trim();l&&F(l,e,a)}})}function z(e,r){if(!navigator.geolocation){$(m("geolocationNotSupported"),r);return}try{v(r,`<div class="loading">${m("gettingLocation")}...</div>`)}catch(t){r.textContent="Getting location...",console.error("Sanitization failed:",t)}navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:s}=t.coords;C(o,s,e,r)},t=>{let o=m("locationError");switch(t.code){case t.PERMISSION_DENIED:o=m("locationPermissionDenied");break;case t.POSITION_UNAVAILABLE:o=m("locationUnavailable");break;case t.TIMEOUT:o=m("locationTimeout");break}$(o,r)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}async function F(e,r,t){try{v(t,`<div class="loading">${m("searchingLocation")}...</div>`)}catch(n){t.textContent="Searching location...",console.error("Sanitization failed:",n)}const o=/^(-?\d+\.?\d*)\s*,\s*(-?\d+\.?\d*)$/,s=e.trim().match(o);if(s){const n=parseFloat(s[1]),a=parseFloat(s[2]);if(n>=47.2&&n<=52.5&&a>=5.9&&a<=15){try{v(t,`
          <div class="location-success">
            <p>üìç Coordinates: ${n.toFixed(4)}, ${a.toFixed(4)}</p>
          </div>
        `)}catch(i){t.textContent=`Coordinates: ${n.toFixed(4)}, ${a.toFixed(4)}`,console.error("Sanitization failed:",i)}setTimeout(()=>{C(n,a,r,t)},500);return}$("Coordinates appear to be outside Germany. Please check the values.",t);return}try{let n=e.trim();!n.toLowerCase().includes("deutschland")&&!n.toLowerCase().includes("germany")&&!n.toLowerCase().includes("bayern")&&!n.toLowerCase().includes("bavaria")&&!n.toLowerCase().includes("nordrhein")&&!n.toLowerCase().includes("baden")&&(n+=", Deutschland");const i=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(n)}&countrycodes=de&format=json&limit=3&addressdetails=1`,l=await fetch(i,{method:"GET",headers:{Accept:"application/json","User-Agent":"iGFAP-StrokeTriage/2.1.0"}});if(!l.ok)throw new Error(`Geocoding API error: ${l.status}`);const c=await l.json();if(c&&c.length>0){let p=c[0];const k=["Bayern","Baden-W√ºrttemberg","Nordrhein-Westfalen"];for(const g of c)if(g.address&&k.includes(g.address.state)){p=g;break}const S=parseFloat(p.lat),f=parseFloat(p.lon),M=p.display_name||e;try{v(t,`
          <div class="location-success">
            <p>üìç Found: ${M}</p>
            <small style="color: #666;">Lat: ${S.toFixed(4)}, Lng: ${f.toFixed(4)}</small>
          </div>
        `)}catch(g){t.textContent=`Found: ${M} (${S.toFixed(4)}, ${f.toFixed(4)})`,console.error("Sanitization failed:",g)}setTimeout(()=>{C(S,f,r,t)},1e3)}else $(`
        <strong>Location "${e}" not found.</strong><br>
        <small>Try:</small>
        <ul style="text-align: left; font-size: 0.9em; margin: 10px 0;">
          <li>City name: "M√ºnchen", "K√∂ln", "Stuttgart"</li>
          <li>Address: "Marienplatz 1, M√ºnchen"</li>
          <li>Coordinates: "48.1351, 11.5820"</li>
        </ul>
      `,t)}catch(n){$(`
      <strong>Unable to search location.</strong><br>
      <small>Please try entering coordinates directly (e.g., "48.1351, 11.5820")</small>
    `,t)}}async function C(e,r,t,o){var i,l,c,p,k,S,f,M,g;const s={lat:e,lng:r},n=O.routePatient({location:s,ichProbability:((i=t==null?void 0:t.ich)==null?void 0:i.probability)||0,timeFromOnset:(t==null?void 0:t.timeFromOnset)||null,clinicalFactors:(t==null?void 0:t.clinicalFactors)||{}});if(!n||!n.destination){try{v(o,`
        <div class="location-error">
          <p>‚ö†Ô∏è No suitable stroke centers found in this area.</p>
          <p><small>Please try a different location or contact emergency services directly.</small></p>
        </div>
      `)}catch(b){o.textContent="No suitable stroke centers found in this area. Please try a different location or contact emergency services directly.",console.error("Sanitization failed:",b)}return}const a=V(n,t);try{v(o,`
      <div class="location-info">
        <p><strong>${m("yourLocation")}:</strong> ${e.toFixed(4)}, ${r.toFixed(4)}</p>
        <p><strong>Detected State:</strong> ${R(n.state)}</p>
      </div>
      <div class="loading">${m("calculatingTravelTimes")}...</div>
    `)}catch(b){o.textContent=`Your Location: ${e.toFixed(4)}, ${r.toFixed(4)}. Calculating travel times...`,console.error("Sanitization failed:",b)}try{const b=U[n.state],T=[...b.neurosurgicalCenters,...b.comprehensiveStrokeCenters,...b.regionalStrokeUnits,...b.thrombolysisHospitals||[]],{destination:u}=n;u.distance=P(e,r,u.coordinates.lat,u.coordinates.lng);try{const d=await L(e,r,u.coordinates.lat,u.coordinates.lng);u.travelTime=d.duration,u.travelSource=d.source}catch(d){u.travelTime=Math.round(u.distance/.8),u.travelSource="estimated"}const h=T.filter(d=>d.id!==u.id).map(d=>({...d,distance:P(e,r,d.coordinates.lat,d.coordinates.lng)})).sort((d,y)=>d.distance-y.distance).slice(0,3);console.log("üè• Stroke Center Debug:",{primaryDestination:u.name,alternativesCount:h.length,alternativeNames:h.map(d=>d.name),allHospitalsCount:T.length,routingState:n.state});for(const d of h)try{const y=await L(e,r,d.coordinates.lat,d.coordinates.lng);d.travelTime=y.duration,d.travelSource=y.source}catch(y){d.travelTime=Math.round(d.distance/.8),d.travelSource="estimated"}const E=`
      <div class="location-info">
        <p><strong>${m("yourLocation")}:</strong> ${e.toFixed(4)}, ${r.toFixed(4)}</p>
        <p><strong>State:</strong> ${R(n.state)}</p>
        ${a}
      </div>
      
      <div class="recommended-centers">
        <h4>üè• ${n.urgency==="IMMEDIATE"?"Emergency":"Recommended"} Destination</h4>
        ${I(u,!0,n)}
      </div>
      
      ${h.length>0?`
        <div class="alternative-centers">
          <h4>Alternative Centers</h4>
          ${h.map(d=>I(d,!1,n)).join("")}
        </div>
      `:""}
      
      <div class="travel-time-note">
        <small>${m("travelTimeNote")||"Travel times estimated for emergency vehicles"}</small>
      </div>
    `;try{o.innerHTML="";const d=document.createElement("div");d.className="stroke-center-enhanced";const y=document.createElement("div");y.className="location-info",y.innerHTML=`
        <p><strong>Your Location:</strong> ${e.toFixed(4)}, ${r.toFixed(4)}</p>
        <p><strong>State:</strong> ${R(n.state)}</p>
        ${a}
      `,d.appendChild(y);const w=document.createElement("div");w.className="recommended-centers",w.innerHTML=`<h4>üè• ${n.urgency==="IMMEDIATE"?"Emergency":"Recommended"} Destination</h4>`;const x=K(u,!0,n);if(w.appendChild(x),d.appendChild(w),h.length>0){const N=document.createElement("div");N.className="alternative-centers",N.innerHTML="<h4>Alternative Centers</h4>",h.forEach(W=>{const D=K(W,!1,n);N.appendChild(D)}),d.appendChild(N)}const B=document.createElement("div");B.className="travel-time-note",B.innerHTML="<small>Travel times estimated for emergency vehicles</small>",d.appendChild(B),o.appendChild(d),G(o)}catch(d){console.error("üö® Stroke Center Display Error:",d),o.innerHTML=`
        <div class="stroke-center-fallback">
          <h4>üè• Recommended Center</h4>
          <p><strong>${((l=n==null?void 0:n.destination)==null?void 0:l.name)||"Unknown Hospital"}</strong></p>
          <p>üìç ${((c=n==null?void 0:n.destination)==null?void 0:c.address)||"Address not available"}</p>
          <p>üìû ${((p=n==null?void 0:n.destination)==null?void 0:p.emergency)||((k=n==null?void 0:n.destination)==null?void 0:k.phone)||"Phone not available"}</p>
          <p>üìè Distance: ${((f=(S=n==null?void 0:n.destination)==null?void 0:S.distance)==null?void 0:f.toFixed(1))||"?"} km</p>
          ${(h==null?void 0:h.length)>0?`<p><strong>+ ${h.length} alternative centers nearby</strong></p>`:""}
        </div>
      `}}catch(b){try{v(o,`
        <div class="location-info">
          <p><strong>${m("yourLocation")}:</strong> ${e.toFixed(4)}, ${r.toFixed(4)}</p>
          ${a}
        </div>

        <div class="recommended-centers">
          <h4>Recommended Center</h4>
          <div class="stroke-center-card recommended">
            <div class="center-header">
              <h5>${n.destination.name}</h5>
              <span class="distance">${((M=n.destination.distance)==null?void 0:M.toFixed(1))||"?"} km</span>
            </div>
            <div class="center-details">
              <p class="address">üìç ${n.destination.address}</p>
              <p class="phone">üìû ${n.destination.emergency||n.destination.phone}</p>
            </div>
          </div>
        </div>

        <div class="routing-reasoning">
          <p><strong>Routing Logic:</strong> ${n.reasoning}</p>
        </div>
      `)}catch(T){o.textContent=`Your Location: ${e.toFixed(4)}, ${r.toFixed(4)}. Recommended Center: ${n.destination.name} - ${((g=n.destination.distance)==null?void 0:g.toFixed(1))||"?"} km`,console.error("Sanitization failed:",T)}}}function R(e){return{bayern:"Bayern (Bavaria)",badenWuerttemberg:"Baden-W√ºrttemberg",nordrheinWestfalen:"Nordrhein-Westfalen (NRW)"}[e]||e}function V(e,r){var s;const t=Math.round((((s=r==null?void 0:r.ich)==null?void 0:s.probability)||0)*100);let o="üè•";return e.urgency==="IMMEDIATE"?o="üö®":e.urgency==="TIME_CRITICAL"?o="‚è∞":e.urgency==="URGENT"&&(o="‚ö†Ô∏è"),`
    <div class="routing-explanation ${e.category.toLowerCase()}">
      <div class="routing-header">
        <strong>${o} ${e.category.replace("_"," ")} - ${e.urgency}</strong>
      </div>
      <div class="routing-details">
        <p><strong>ICH Risk:</strong> ${t}% ${e.threshold?`(${e.threshold})`:""}</p>
        ${e.timeWindow?`<p><strong>Time Window:</strong> ${e.timeWindow}</p>`:""}
        <p><strong>Routing Logic:</strong> ${e.reasoning}</p>
        <p><strong>Pre-Alert:</strong> ${e.preAlert}</p>
        ${e.bypassLocal?'<p class="bypass-warning">‚ö†Ô∏è Bypassing local hospitals</p>':""}
      </div>
    </div>
  `}function I(e,r,t){const o=[];e.neurosurgery&&o.push("üß† Neurosurgery"),e.thrombectomy&&o.push("ü©∏ Thrombectomy"),e.thrombolysis&&o.push("üíâ Thrombolysis");const s=e.network?`<span class="network-badge">${e.network}</span>`:"";return`
    <div class="stroke-center-card ${r?"recommended":"alternative"} enhanced">
      <div class="center-header">
        <h5>${e.name}</h5>
        <div class="center-badges">
          ${e.neurosurgery?'<span class="capability-badge neurosurgery">NS</span>':""}
          ${e.thrombectomy?'<span class="capability-badge thrombectomy">TE</span>':""}
          ${s}
        </div>
      </div>
      
      <div class="center-metrics">
        ${e.travelTime?`
          <div class="travel-info">
            <span class="travel-time">${e.travelTime} min</span>
            <span class="distance">${e.distance.toFixed(1)} km</span>
          </div>
        `:`
          <div class="distance-only">
            <span class="distance">${e.distance.toFixed(1)} km</span>
          </div>
        `}
        <div class="bed-info">
          <span class="beds">${e.beds} beds</span>
        </div>
      </div>
      
      <div class="center-details">
        <p class="address">üìç ${e.address}</p>
        <p class="phone">üìû ${e.emergency||e.phone}</p>
        
        ${o.length>0?`
          <div class="capabilities">
            ${o.join(" ‚Ä¢ ")}
          </div>
        `:""}
      </div>
      
      <div class="center-actions">
        <button class="call-button" data-phone="${e.emergency||e.phone}">
          üìû Call
        </button>
        <button class="directions-button" data-lat="${e.coordinates.lat}" data-lng="${e.coordinates.lng}">
          üß≠ Directions
        </button>
      </div>
    </div>
  `}function K(e,r,t){const o=document.createElement("div");o.className=`stroke-center-card ${r?"recommended":"alternative"} enhanced`;const s=[];e.neurosurgery&&s.push("üß† Neurosurgery"),e.thrombectomy&&s.push("ü©∏ Thrombectomy"),e.thrombolysis&&s.push("üíâ Thrombolysis");const n=e.network?`<span class="network-badge">${e.network}</span>`:"";return o.innerHTML=`
    <div class="center-header">
      <h5>${e.name}</h5>
      <div class="center-badges">
        ${e.neurosurgery?'<span class="capability-badge neurosurgery">NS</span>':""}
        ${e.thrombectomy?'<span class="capability-badge thrombectomy">TE</span>':""}
        ${n}
      </div>
    </div>

    <div class="center-metrics">
      ${e.travelTime?`
        <div class="travel-info">
          <span class="travel-time">${e.travelTime} min</span>
          <span class="distance">${e.distance.toFixed(1)} km</span>
        </div>
      `:`
        <div class="distance-only">
          <span class="distance">${e.distance.toFixed(1)} km</span>
        </div>
      `}
      <div class="bed-info">
        <span class="beds">${e.beds} beds</span>
      </div>
    </div>

    <div class="center-details">
      <p class="address">üìç ${e.address}</p>
      <p class="phone">üìû ${e.emergency||e.phone}</p>

      ${s.length>0?`
        <div class="capabilities">
          ${s.join(" ‚Ä¢ ")}
        </div>
      `:""}
    </div>

    <div class="center-actions">
      <button class="call-button" data-phone="${e.emergency||e.phone}">
        üìû Call
      </button>
      <button class="directions-button" data-lat="${e.coordinates.lat}" data-lng="${e.coordinates.lng}">
        üß≠ Directions
      </button>
    </div>
  `,o}function G(e){const r=e.querySelectorAll(".call-button"),t=e.querySelectorAll(".directions-button");r.forEach(o=>{o.addEventListener("click",()=>{const{phone:s}=o.dataset;s&&window.open(`tel:${s}`)})}),t.forEach(o=>{o.addEventListener("click",()=>{const{lat:s}=o.dataset,{lng:n}=o.dataset;s&&n&&window.open(`https://maps.google.com/maps?daddr=${s},${n}`,"_blank")})})}function $(e,r){try{v(r,`
      <div class="location-error">
        <p>‚ö†Ô∏è ${e}</p>
        <p><small>${m("tryManualEntry")}</small></p>
      </div>
    `)}catch(t){r.textContent=`Error: ${e}. ${m("tryManualEntry")||"Try manual entry"}`,console.error("Sanitization failed:",t)}}function Z(e){if(!e||e<=0)return`
      <div class="volume-circle" data-volume="0">
        <div class="volume-number">0<span> ml</span></div>
        <canvas class="volume-canvas" width="120" height="120"></canvas>
      </div>
    `;const r=H(e),t=`volume-canvas-${Math.random().toString(36).substr(2,9)}`;return`
    <div class="volume-circle" data-volume="${e}">
      <div class="volume-number">${r}</div>
      <canvas id="${t}" class="volume-canvas" 
              data-volume="${e}" data-canvas-id="${t}"></canvas>
    </div>
  `}function ee(){document.querySelectorAll(".volume-canvas").forEach(r=>{const t=r.offsetWidth||120,o=r.offsetHeight||120;r.width=t,r.height=o;const s=parseFloat(r.dataset.volume)||0;s>0&&_(r,s)})}function _(e,r){const t=e.getContext("2d"),o=e.width/2,s=e.height/2,n=e.width*.45;let a=0,i=!0;const l=document.body.classList.contains("dark-mode")||window.matchMedia("(prefers-color-scheme: dark)").matches;function c(){i&&(t.clearRect(0,0,e.width,e.height),p())}function p(){const M=Math.min(r/80,.9)*(n*1.8),g=s+n-4-M;if(r>0){t.save(),t.beginPath(),t.arc(o,s,n-4,0,Math.PI*2),t.clip(),t.fillStyle="#dc2626",t.globalAlpha=.7,t.fillRect(0,g+5,e.width,e.height),t.globalAlpha=.9,t.fillStyle="#dc2626",t.beginPath();const h=o-n+4;t.moveTo(h,g);for(let E=h;E<=o+n-4;E+=2){const d=Math.sin(E*.05+a*.08)*3,y=Math.sin(E*.08+a*.12+1)*2,w=g+d+y;t.lineTo(E,w)}t.lineTo(o+n-4,e.height),t.lineTo(h,e.height),t.closePath(),t.fill(),t.restore()}const b=getComputedStyle(document.documentElement).getPropertyValue("--text-secondary").trim()||(l?"#8899a6":"#6c757d");t.strokeStyle=b,t.lineWidth=8,t.globalAlpha=.4,t.beginPath(),t.arc(o,s,n,0,Math.PI*2),t.stroke(),t.globalAlpha=1;const T=Math.min(r/100,1),u=getComputedStyle(document.documentElement).getPropertyValue("--danger-color").trim()||"#dc2626";t.strokeStyle=u,t.lineWidth=8,t.setLineDash([]),t.lineCap="round",t.beginPath(),t.arc(o,s,n,-Math.PI/2,-Math.PI/2+T*2*Math.PI),t.stroke(),a+=1,r>0&&requestAnimationFrame(c)}c();const k=new MutationObserver(()=>{document.contains(e)||(i=!1,k.disconnect())});k.observe(document.body,{childList:!0,subtree:!0})}export{U as C,Z as a,Q as b,ee as i,X as r};
//# sourceMappingURL=ui-components-tkCfQkE0.js.map
